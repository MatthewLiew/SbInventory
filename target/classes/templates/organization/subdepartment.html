<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
	<title>Sub Department</title>
	</head>

	<div class="header_ref" th:include="/header"></div>
	<div class="content-wrapper">
   		<div class="container-fluid">
   		
   			<div th:if="${message!= null}" class="alert alert-info alert-dismissible">
			    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
				<span  th:text="${message}"></span>
		  	</div>
		  	
	   		<!-- Breadcrumbs -->
	    	<ol class="breadcrumb">
		        <li class="breadcrumb-item">
		          <!-- <a th:href="''#"> -->Manage<!-- </a> -->
		        </li>
		        <li class="breadcrumb-item">Organization & Departments</li>
		        <li class="breadcrumb-item active">Sub Department</li>
	      	</ol>
	      	
	      	<div class="card mb-3">
	      		<div class="card-header">
	      			<i class="fa fa-table"></i> Sub Department &nbsp;&nbsp;
	      			<a onclick="doAction('new', 0);">
	      				<button class="btn btn-primary" data-toggle="modal" >Create Sub Department</button>
	      			</a>
	      		</div>	  	
		        <div class="card-body">
		        	<div class="table-responsive">
		        		<table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
		        			<thead>
		        				<tr>
		          					<th>Sub Department Code</th>
		          					<th>Sub Department Name</th>
				                  	<th>By Department</th>
				                  	<th>By Organization</th>
				                  	<th>Action</th>
	               			 	</tr>
		              		</thead>
		              		<tfoot>
		                		<tr>
		          					<th>Sub Department Code</th>
		          					<th>Sub Department Name</th>
		          					<th>By Department</th>
				                  	<th>By Organization</th>
				                  	<th>Action</th>
			                  	</tr>
		                  	</tfoot>
		                  	<tbody>
		                		<tr th:each="subdept : ${subdepts}" th:if="${subdept.subdeptid}>0">
					             	<td th:text="${subdept.subdeptcode}"></td>
				          		 	<td th:text="${subdept.subdeptname}"></td> 		
				          		 	<td th:each="dept : ${depts}" th:if="${dept.isDeptname(subdept.deptid)}" th:text="${dept.deptname}"></td>
				          		 	<td th:each="dept : ${depts}" th:if="${dept.isDeptname(subdept.deptid)}"><span th:each="org : ${orgs}" th:if="${org.isOrgname(dept.orgid)}" th:text="${org.orgname}"></span></td>			             	
						            <td>
						                <a th:onclick="'doAction(\'edit\',\''+ ${subdept.subdeptid} + '\');'" ><button class="btn btn-primary" title="Edit Sub Department"><i class="fa fa-edit" title="Edit Sub Department"></i></button></a>
						            	<a th:onclick="'doAction(\'delete\',\''+ ${subdept.subdeptid} +'\');'"><button class="btn btn-primary" title="Delete Sub Department"><i class="fa fa-trash" title="Delete Sub Department"></i></button></a>
					            	</td>
					            </tr>
		              		</tbody>
	                  	</table>
                  	</div>
               	</div>
               	<div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
           	</div>
           	
           	<div class="modal clickable" id="CreateSubDepartment" tabindex="-1" role="dialog" aria-labelledby="CreateSubDepartment" aria-hidden="true">
	            <form method="POST" th:action="@{/subdepartment/createSubDepartment}" id="CreateSubDepartment" onsubmit="return subdeptForm('CreateSubDepartment')">
	                <div class="vertical-alignment-helper">
	                    <div class="modal-dialog  modal-lg vertical-align-center">
	                        <!-- Modal content-->
	                        <div class="modal-content">
	                            <div class="modal-header">
	                                <h4 class="modal-title">Create Sub Department</h4>
	                                <button type="button" class="close" data-dismiss="modal">&times;</button>
	                            </div>
	                            
	                            <div class="alert alert-danger" role="alert" id="modal_error" style="display:none;"></div>
	
	                            <div class="modal-body">
	
	                            </div>
	
	                            <div class="modal-footer">
	                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	                                <button type="submit" class="btn btn-primary">Save</button>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	            </form>
	        </div>
	        
	        <div class="modal clickable" id="EditSubDepartment" tabindex="-1" role="dialog" aria-labelledby="EditSubDepartment" aria-hidden="true">
	            <form method="POST" th:action="@{/subdepartment/editSubDepartment}" id="EditSubDepartment" onsubmit="return subdeptForm('EditSubDepartment')">
	                <div class="vertical-alignment-helper">
	                    <div class="modal-dialog  modal-lg vertical-align-center">
	                        <!-- Modal content-->
	                        <div class="modal-content">
	                            <div class="modal-header">
	                                <h4 class="modal-title">Edit Sub Department</h4>
	                                <button type="button" class="close" data-dismiss="modal">&times;</button>
	                            </div>
	                            
	                            <div class="alert alert-danger" role="alert" id="modal_error" style="display:none;"></div>
	
	                            <div class="modal-body">
	
	                            </div>
	
	                            <div class="modal-footer">
	                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	                                <button type="submit" class="btn btn-primary">Save</button>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	            </form>
	        </div>
	        
	        <div class="modal clickable" id="DeleteSubDepartment" tabindex="-1" role="dialog" aria-labelledby="DeleteSubDepartment" aria-hidden="true">
	            <form method="POST" th:action="@{/subdepartment/deleteSubDepartment}" id="DeleteSubDepartment">
	                <div class="vertical-alignment-helper">
	                    <div class="modal-dialog  modal-lg vertical-align-center">
	                        <!-- Modal content-->
	                        <div class="modal-content">
	                            <div class="modal-header">
	                                <h4 class="modal-title">Delete Sub Department</h4>
	                                <button type="button" class="close" data-dismiss="modal">&times;</button>
	                            </div>
	                            
	                            <div class="alert alert-danger" role="alert" id="modal_error" style="display:none;"></div>
	
	                            <div class="modal-body">
	
	                            </div>
	
	                            <div class="modal-footer">
	                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	                                <button type="submit" class="btn btn-primary">Delete</button>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	            </form>
	        </div>  
	   	</div><!-- end of .container-fluid-->
   	</div><!-- end of .content-wrapper-->
	<div class="footer_ref" th:include="/footer"></div> 
	
	<script type="text/javascript">
        function doAction(action, id) {
            if (action == 'new') {
                $('#CreateSubDepartment .modal-body').empty();
                $('#CreateSubDepartment .modal-title').text("New Sub Department");
                $('#CreateSubDepartment #modal_error').hide();
                $('#CreateSubDepartment .modal-body').load('/subdepartment/createSubDepartment', function () {
                    $('#CreateSubDepartment').modal({show: true});
                });
            } else if (action == 'edit') {
                $('#EditSubDepartment .modal-body').empty();
                $('#EditSubDepartment .modal-title').text("Edit Sub Department");
                $('#EditSubDepartment #modal_error').hide();
                $('#EditSubDepartment .modal-body').load('/subdepartment/editSubDepartment?subdeptid=' + id, function () {
                    $('#EditSubDepartment').modal({show: true});
                });
            } else if (action == 'change') {
            	console.log("change");
                $('#ChangePwd .modal-body').empty();
                $('#ChangePwd .modal-title').text("Change Password");
                $('#ChangePwd .modal-body').load('changePassword?userid=' + id, function () {
                    $('#ChangePwd').modal({show: true});
                });
            } else if (action == 'delete') {
                $('#DeleteSubDepartment .modal-body').empty();
                $('#DeleteSubDepartment .modal-title').text("Delete Sub Department");
                $('#DeleteSubDepartment .modal-body').load('/subdepartment/deleteSubDepartment?subdeptid=' + id, function () {
                    $('#DeleteSubDepartment').modal({show: true});
                });
            }
        }
    </script>
</html>